form_templates

create table public.form_templates (
  id uuid not null default gen_random_uuid (),
  title text not null,
  description text null,
  status text not null default 'draft'::text,
  created_by uuid null,
  created_at timestamp with time zone null default now(),
  updated_at timestamp with time zone null default now(),
  constraint form_templates_pkey primary key (id),
  constraint form_templates_created_by_fkey foreign KEY (created_by) references auth.users (id),
  constraint form_templates_status_check check (
    (
      status = any (
        array['draft'::text, 'active'::text, 'archived'::text]
      )
    )
  )
) TABLESPACE pg_default;

create trigger update_form_templates_modtime BEFORE
update on form_templates for EACH row
execute FUNCTION update_updated_at_column ();



form_sections

create table public.form_sections (
  id uuid not null default gen_random_uuid (),
  form_id uuid not null,
  title text not null,
  description text null,
  order_index integer null default 0,
  created_at timestamp with time zone null default now(),
  updated_at timestamp with time zone null default now(),
  constraint form_sections_pkey primary key (id),
  constraint form_sections_form_id_fkey foreign KEY (form_id) references form_templates (id) on delete CASCADE
) TABLESPACE pg_default;

create trigger update_form_sections_modtime BEFORE
update on form_sections for EACH row
execute FUNCTION update_updated_at_column ();


form_items

create table public.form_items (
  id uuid not null default gen_random_uuid (),
  section_id uuid not null,
  type text not null default 'text'::text,
  label text not null,
  help_text text null,
  order_index integer null default 0,
  validation_rules jsonb null default '{}'::jsonb,
  created_at timestamp with time zone null default now(),
  updated_at timestamp with time zone null default now(),
  short_name text null,
  constraint form_items_pkey primary key (id),
  constraint form_items_section_id_fkey foreign KEY (section_id) references form_sections (id) on delete CASCADE
) TABLESPACE pg_default;

create trigger update_form_items_modtime BEFORE
update on form_items for EACH row
execute FUNCTION update_updated_at_column ();


form_item_options

create table public.form_item_options (
  id uuid not null default gen_random_uuid (),
  item_id uuid not null,
  label text not null,
  value text null,
  is_default boolean null default false,
  is_correct boolean null default false,
  color text null default 'gray'::text,
  order_index integer null default 0,
  created_at timestamp with time zone null default now(),
  updated_at timestamp with time zone null default now(),
  constraint form_item_options_pkey primary key (id),
  constraint form_item_options_item_id_fkey foreign KEY (item_id) references form_items (id) on delete CASCADE
) TABLESPACE pg_default;

create trigger update_form_item_options_modtime BEFORE
update on form_item_options for EACH row
execute FUNCTION update_updated_at_column ();



feedback_general

create table public.feedback_general (
  id uuid not null default gen_random_uuid (),
  option_id uuid null,
  user_id uuid null,
  feedback_text text not null,
  created_at timestamp with time zone null default now(),
  updated_at timestamp with time zone null default now(),
  constraint feedback_general_pkey primary key (id),
  constraint feedback_general_option_id_user_id_key unique (option_id, user_id),
  constraint feedback_general_option_id_fkey foreign KEY (option_id) references form_item_options (id) on delete CASCADE,
  constraint feedback_general_user_id_fkey foreign KEY (user_id) references auth.users (id) on delete CASCADE
) TABLESPACE pg_default;

create trigger update_feedback_general_modtime BEFORE
update on feedback_general for EACH row
execute FUNCTION update_modified_column ();


audit_submissions

create table public.audit_submissions (
  id uuid not null default gen_random_uuid (),
  form_id uuid null,
  interaction_id text null,
  advocate_name text null,
  call_ani_dnis text null,
  interaction_date timestamp with time zone null,
  evaluation_date timestamp with time zone null default now(),
  case_number text null,
  call_duration text null,
  case_category text null,
  issue_concern text null,
  page_url text null,
  submitted_by uuid null,
  submitted_at timestamp with time zone null default now(),
  created_at timestamp with time zone null default now(),
  updated_at timestamp with time zone null default now(),
  qa_score numeric null,
  constraint audit_submissions_pkey primary key (id),
  constraint audit_submissions_form_id_fkey foreign KEY (form_id) references tracker_audit_forms (id) on delete set null,
  constraint audit_submissions_submitted_by_fkey foreign KEY (submitted_by) references auth.users (id)
) TABLESPACE pg_default;

create trigger update_audit_submissions_modtime BEFORE
update on audit_submissions for EACH row
execute FUNCTION update_modified_column ();


audit_submission_items

create table public.audit_submission_items (
  id uuid not null default gen_random_uuid (),
  submission_id uuid null,
  item_id uuid null,
  answer_text text null,
  answer_id uuid null,
  feedback_text text null,
  created_at timestamp with time zone null default now(),
  selected_tags uuid[] null default '{}'::uuid[],
  constraint audit_submission_items_pkey primary key (id),
  constraint audit_submission_items_answer_id_fkey foreign KEY (answer_id) references tracker_audit_item_options (id) on delete set null,
  constraint audit_submission_items_item_id_fkey foreign KEY (item_id) references tracker_audit_items (id) on delete set null,
  constraint audit_submission_items_submission_id_fkey foreign KEY (submission_id) references audit_submissions (id) on delete CASCADE
) TABLESPACE pg_default;



